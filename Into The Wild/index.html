<html>
<head>
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v7.0.0/dist/aframe-extras.min.js"></script>
  <script src="https://unpkg.com/@croquet/croquet"></script>
  <script src="https://unpkg.com/aframe-croquet-component/public/lib/aframe-croquet-component.js"></script>
  <script src="https://gftruj.github.io/webzamples/aframe/controls/oculus-thumbstick-controls.js"></script>

  <script>
    AFRAME.registerComponent('sounding', {
      tick: function () {
        if (Math.random() < 0.99) return;
        var sound = this.el.components.sound;
        if (sound) sound.playSound();
      }
    });
  </script>

  <script>
    AFRAME.registerComponent('flying', {
      tick: function () {
        if (Math.random() < 0.5) return;
        var x = Math.random() * 100 - 50;
        var y = Math.random() * 3 + 3;
        var z = Math.random() * 100 - 50;
        this.el.setAttribute('animation', 'property: position; to: ' + x + ' ' + y + ' ' + z);
      }
    });
  </script>
</head>

<body>
  <a-scene id="s1" background="color:#0d0928" fog="far:300" shadow="type: pcfsoft" croquet>
    <!-- camera, lights, ground, assets go here -->
    <a-assets>
      <a-asset-item id="tree" src="assets/tree.gltf"></a-asset-item>
      <a-asset-item id="bird" src="assets/bird.gltf"></a-asset-item>
      <a-asset-item id="bee" src="assets/bee.gltf"></a-asset-item>
      <a-asset-item id="witch" src="assets/witch.glb"></a-asset-item>
      <audio id="hawk" src="assets/Hawk.mp3"></audio>
      <audio id="bzzz" src="assets/Bee.mp3"></audio>
    </a-assets>
  </a-scene>

  <script>
    var scene1 = document.getElementById('s1');

    // Add trees
    for (var i = 0; i < 500; i++) {
      var tree = document.createElement('a-entity');
      var x = Math.random() * 800 - 400;
      var z = Math.random() * 800 - 400;
      var s = Math.random() * 15 + 5;
      var r = Math.random() * 180 - 90;
      tree.setAttribute('gltf-model', '#tree');
      tree.setAttribute('position', x + ' 0 ' + z);
      tree.setAttribute('scale', s + ' ' + s + ' ' + s);
      tree.setAttribute('rotation', '0 ' + r + ' 0');
      scene1.appendChild(tree);
    }

    // Add bees
    for (var i = 0; i < 10; i++) {
      var bee = document.createElement('a-entity');
      var x = Math.random() * 10 - 5;
      var y = Math.random() * 3 + 3;
      var z = Math.random() * 10 - 5;
      var r = Math.random() * 180 - 90;
      bee.setAttribute('gltf-model', '#bee');
      bee.setAttribute('position', x + ' ' + y + ' ' + z);
      bee.setAttribute('scale', '0.01 0.01 0.01');
      bee.setAttribute('rotation', '0 ' + r + ' 0');
      bee.setAttribute('sound', 'src:#bzzz; volume: 0.1; poolSize: 10');
      bee.setAttribute('sounding', '');
      bee.setAttribute('flying', '');
      scene1.appendChild(bee);
    }
  </script>
</body>
</html>

