<html>
<head>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
    <script>
    // ΕΔΩ ΤΟΠΟΘΕΤΩ ΤΑ ΣΥΣΤΑΤΙΚΑ (COMPONENTS) ΠΟΥ ΕΧΩ ΔΗΜΙΟΥΡΓΗΣΕΙ
        
 AFRAME.registerComponent('scatter-trees', {
      schema: {
        path: { type: 'selector' }, // The plane/entity around which to scatter trees
        treeModels: { default: ['#SpookyTree1','#SpookyTree2','#SpookyTree3','#SpookyTree4','#SpookyTrees'] },
        count: { type: 'int', default: 30 },
        minOffset: { type: 'number', default: 1 },  // min distance from plane center
        maxOffset: { type: 'number', default: 6 },  // max distance from plane center
        forwardRange: { type: 'number', default: 6 } // variation along plane width/length
      },

      init: function() {
        const scene = this.el.sceneEl;
        const pathEl = this.data.path;
        if (!pathEl) return console.error('scatter-trees: path not found!');

        // Wait for model/plane to load (for safety)
        if (!pathEl.hasLoaded) {
          pathEl.addEventListener('model-loaded', () => this.spawnTrees(pathEl, scene));
        } else {
          this.spawnTrees(pathEl, scene);
        }
      },

      spawnTrees: function(pathEl, scene) {
        const planePos = pathEl.getAttribute('position');
        const planeRot = pathEl.getAttribute('rotation') || { x:0, y:0, z:0 };
        const angle = AFRAME.THREE.Math.degToRad(planeRot.y || 0);

        for (let i = 0; i < this.data.count; i++) {
          const treeEl = document.createElement('a-entity');
          const modelId = this.data.treeModels[Math.floor(Math.random() * this.data.treeModels.length)];
          treeEl.setAttribute('gltf-model', modelId);

          // Offset from center of plane
          const side = (Math.random() > 0.5 ? 1 : -1) * 
                       (this.data.minOffset + Math.random() * (this.data.maxOffset - this.data.minOffset));
          const forward = (Math.random() - 0.5) * this.data.forwardRange;

          // Apply rotation so offset follows plane orientation
          const x = planePos.x + Math.cos(angle) * forward + Math.sin(angle) * side;
          const z = planePos.z + Math.sin(angle) * forward - Math.cos(angle) * side;
          const y = planePos.y; // align with plane height

          // Scale based on tree type
          let baseScale = (modelId === '#SpookyTree1' || modelId === '#SpookyTree2') ? 0.3 : 0.6;
          const scale = baseScale + (Math.random() * 0.2 - 0.1);
          treeEl.setAttribute('scale', { x: scale, y: scale, z: scale });
          treeEl.setAttribute('position', { x, y, z });

          scene.appendChild(treeEl);
        }
      }
    });
  </script>
        
    <style>
        h1 { text-align: center; }
        h3 { text-align: center; }
        a-scene { width: 50%; height: 50%; border: dotted silver 1px; }
    </style>
</head>

<body>
    <h1>ΤΙΤΛΟΣ ΕΡΓΑΣΙΑΣ</h1>
    <h3>Ελένη Ανδρεαδάκη</h3>
    <hr />
    <P><strong>Σενάριο:</strong>...</P>
    <hr />
    <div align="center">
    <!-- ΕΔΩ ΠΕΡΙΓΡΑΦΩ ΤΗ ΣΚΗΝΗ -->

 <a-scene cursor="rayOrigin: mouse" background="color: cadetblue" ondblclick="this.requestFullscreen();" embedded>

      <a-assets>
        <a-asset-item id="pathModel" src="assets/trail_path.glb"></a-asset-item>
        <a-asset-item id="SpookyTree1" src="assets/dead_tree2.glb"></a-asset-item>
        <a-asset-item id="SpookyTree2" src="assets/dead_tree.glb"></a-asset-item>
        <a-asset-item id="SpookyTree3" src="assets/old_tree2.glb"></a-asset-item>
        <a-asset-item id="SpookyTree4" src="assets/old_tree.glb"></a-asset-item>
        <a-asset-item id="SpookyTrees" src="assets/dead_trees_demo.glb"></a-asset-item>
      </a-assets>

      <!-- Planes -->
      <a-plane src="assets/Ground024_8K-JPG_Color.jpg" rotation="-90 0 0" width="40" height="40" repeat="30 30" material="roughness: 1" position="0 -0.70374 5.67534" scale="0.7 0.7 1"></a-plane>

      <a-plane id="SecondPlane" src="assets/Ground024_8K-JPG_Color.jpg" rotation="-76.89 0 0" width="40" height="40" repeat="30 30" material="roughness: 1" position="-14.39576 1.98933 -18.5696" scale="0.7 0.7 1"></a-plane>

      <a-plane src="assets/Ground024_8K-JPG_Color.jpg" rotation="-75.39 0 0" width="40" height="40" repeat="30 30" material="roughness: 1" position="12.34806 2.04456 -18.88538" scale="0.7 0.7 1"></a-plane>

      <!-- Paths -->
      <a-entity id="FirstPath" gltf-model="assets/trail_path.glb" position="-0.97842 -0.34188 -0.39029" rotation="-8.85 -21.23 0" scale="1.1 1 1"></a-entity>
      <a-entity id="SpookyPath" gltf-model="assets/trail_path.glb" position="-5.24057 0.16 -8.70607" rotation="-1.75 48.42 0"></a-entity>
      <a-entity id="GoodPath" gltf-model="assets/trail_path.glb" position="3.20235 0.05 -8.73084" rotation="-2.12 -70.23 0"></a-entity>

      <!-- Scatter trees around second plane -->
      <a-entity scatter-trees="path: #SecondPlane; count: 30"></a-entity>

    </a-scene>

    </a-scene>
  </div>
  <hr />
  <p><strong>Οδηγίες:</strong>...</p>
  <hr />
  <p><strong>Credits:</strong></p>
</body>
</html>





