<html>
<head>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
    <script>
    // ΕΔΩ ΤΟΠΟΘΕΤΩ ΤΑ ΣΥΣΤΑΤΙΚΑ (COMPONENTS) ΠΟΥ ΕΧΩ ΔΗΜΙΟΥΡΓΗΣΕΙ
        

<script>
AFRAME.registerComponent('scatter-trees', {
  schema: {
    path: { type: 'selector' }, // the path entity
    treeModels: { default: ['#SpookyTree1','#SpookyTree2','#SpookyTree3','#SpookyTree4','#SpookyTrees'] },
    count: { type: 'int', default: 30 },
    minOffset: { type: 'number', default: 2 },  // min distance from path
    maxOffset: { type: 'number', default: 5 },  // max distance from path
    forwardRange: { type: 'number', default: 6 } // variation along the path
  },

  init: function() {
    const scene = this.el.sceneEl;
    const pathEl = this.data.path;
    if (!pathEl) return console.error('scatter-trees: path not found!');

    // Wait for path model to load
    if (!pathEl.hasLoaded) {
      pathEl.addEventListener('model-loaded', () => this.spawnTrees(pathEl, scene));
    } else {
      this.spawnTrees(pathEl, scene);
    }
  },

  spawnTrees: function(pathEl, scene) {
    const pathPos = pathEl.getAttribute('position');
    const pathRot = pathEl.getAttribute('rotation') || { x:0, y:0, z:0 };
    const angle = THREE.Math.degToRad(pathRot.y);

    for (let i = 0; i < this.data.count; i++) {
      const treeEl = document.createElement('a-entity');
      const modelId = this.data.treeModels[Math.floor(Math.random() * this.data.treeModels.length)];
      treeEl.setAttribute('gltf-model', modelId);

      // Random offset from path (left/right)
      const side = (Math.random() > 0.5 ? 1 : -1) * (this.data.minOffset + Math.random() * (this.data.maxOffset - this.data.minOffset));
      const forward = (Math.random() - 0.5) * this.data.forwardRange;

      // Calculate world position considering path rotation
      const x = pathPos.x + Math.cos(angle) * forward + Math.sin(angle) * side;
      const z = pathPos.z + Math.sin(angle) * forward - Math.cos(angle) * side;
      const y = pathPos.y;

      // Scale based on tree type
      let baseScale = 0.5;
      if (modelId === '#SpookyTree1' || modelId === '#SpookyTree2') {
        baseScale = 0.3; // smaller dead trees
      } else {
        baseScale = 0.6; // bigger for others
      }

      // Randomize slightly
      const scale = baseScale + (Math.random() * 0.2 - 0.1);
      treeEl.setAttribute('scale', { x: scale, y: scale, z: scale });
      treeEl.setAttribute('position', { x, y, z });

      scene.appendChild(treeEl);
    }
  }
});
</script>

        
    <style>
        h1 { text-align: center; }
        h3 { text-align: center; }
        a-scene { width: 50%; height: 50%; border: dotted silver 1px; }
    </style>
</head>

<body>
    <h1>ΤΙΤΛΟΣ ΕΡΓΑΣΙΑΣ</h1>
    <h3>Ελένη Ανδρεαδάκη</h3>
    <hr />
    <P><strong>Σενάριο:</strong>...</P>
    <hr />
    <div align="center">
    <!-- ΕΔΩ ΠΕΡΙΓΡΑΦΩ ΤΗ ΣΚΗΝΗ -->
    <a-scene cursor="rayOrigin: mouse" background="color:cadetblue" ondblclick="this.requestFullscreen();" embedded>

        <a-assets>
            <a-asset-item id="pathModel" src="assets/trail_path.glb"></a-asset-item>
            <a-asset-item id="SpookyTree1" src="assets/dead_tree2.glb"></a-asset-item>
            <a-asset-item id="SpookyTree2" src="assets/dead_tree.glb"></a-asset-item>
            <a-asset-item id="SpookyTree3" src="assets/old_tree2.glb"></a-asset-item>
            <a-asset-item id="SpookyTree4" src="assets/old_tree.glb"></a-asset-item>
            <a-asset-item id="SpookyTrees" src="assets/dead_trees_demo.glb"></a-asset-item>
        </a-assets>

        <a-plane src="assets/Ground024_8K-JPG_Color.jpg"
                 normal-map="src: url(assets/Ground024_8K-JPG_NormalDX.jpg)"
                 roughness-map="src: url(assets/Ground024_8K-JPG_Roughness.jpg)"
                 displacement-map="src: url(assets/Ground024_8K-JPG_Displacement.jpg)"
                 rotation="-90 0 0" width="40" height="40"
                 repeat="30 30"
                 material="roughness: 1;"
                 position="0 -0.66509 -2.86815">
        </a-plane>

        <a-entity id="FirstPath" gltf-model="assets/trail_path.glb"
                  position="-0.93865 -0.38783 -0.36974"
                  rotation="-8.85 -21.23 0"></a-entity>

        <!-- Attach scatter-trees directly to SpookyPath -->
        <a-entity id="SpookyPath" 
                  gltf-model="assets/trail_path.glb"
                  position="-5.32429 0.16 -8.70607"
                  rotation="-1.75 48.42 0"
                  scatter-trees="path: #SpookyPath; count: 30">
        </a-entity>

        <a-entity id="GoodPath" gltf-model="assets/trail_path.glb"
                  position="3.20235 0.05 -8.73084"
                  rotation="-2.12 -70.23 0"></a-entity>

        <a-entity scatter-trees="path: #pathEntity"></a-entity>
<a-entity id="pathEntity" position="0 0 0" rotation="0 90 0"></a-entity>
        
    </a-scene>
    </div>
    <hr />
    <p><strong>Οδηγίες:<strong>...</p>
    <hr />
    <p><strong>Credits:</strong></p>
</body>
</html>
